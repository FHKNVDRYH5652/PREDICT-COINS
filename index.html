<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CoinPredict — Big/Small (50 free coins)</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg1:#071022; --bg2:#071a2a;
    --card:#0f1724; --muted:#9fb0d6;
    --accent:#00d2a8; --accent2:#00a6ff;
    --pink:#ff6b6b; --glass: rgba(255,255,255,0.02);
  }
  *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Arial;}
  body{margin:0;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:#eaf6ff;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:22px}
  .wrap{width:1100px;max-width:98%;display:grid;grid-template-columns:360px 1fr;gap:20px}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 10px 30px rgba(0,0,0,0.6)}
  header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
  .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:800;color:#021}
  h1{margin:0;font-size:18px}
  .muted{color:var(--muted);font-size:13px}
  .wallet{display:flex;align-items:center;justify-content:space-between;gap:8px}
  .coin-badge{background:linear-gradient(90deg,#ffd166,#ffb703);color:#002;padding:8px 10px;border-radius:999px;font-weight:800;box-shadow:0 6px 18px rgba(255,183,3,0.08)}
  .btn{background:linear-gradient(90deg,var(--accent),var(--accent2));border:none;color:#001;padding:10px 12px;border-radius:9px;font-weight:800;cursor:pointer}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
  .small{font-size:13px;color:var(--muted)}
  .input{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
  .center{display:flex;align-items:center;justify-content:center}
  .prediction-area{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .pred-box{background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));padding:14px;border-radius:10px;text-align:center;border:1px solid rgba(255,255,255,0.03)}
  .period{font-weight:800;font-size:14px}
  .result-big{color:#7fe8a7;font-weight:900;font-size:26px}
  .result-small{color:#ffb6b6;font-weight:900;font-size:26px}
  .numbers{font-weight:900;font-size:22px;margin-top:8px}
  .anim-bar{height:6px;background:linear-gradient(90deg,#003,#0ff);border-radius:6px;overflow:hidden;margin-top:12px}
  .progress{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),#8afcff)}
  .history-list{max-height:220px;overflow:auto;padding:6px;border-radius:8px;background:rgba(0,0,0,0.18)}
  .hitem{display:flex;justify-content:space-between;padding:8px;border-bottom:1px solid rgba(255,255,255,0.02)}
  .green{color:#9be3ff}
  .pink{color:#ffb6b6}
  .big-pill{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(123,227,255,0.06);color:#9be3ff;font-weight:800}
  .small-pill{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(255,107,107,0.04);color:#ffb6b6;font-weight:800}
  /* Buy modal */
  .modal {position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);visibility:hidden;opacity:0;transition:all .18s;z-index:9999}
  .modal.show{visibility:visible;opacity:1}
  .modal-card{background:#071022;padding:18px;border-radius:10px;min-width:320px;border:1px solid rgba(255,255,255,0.03)}
  /* small responsive */
  @media(max-width:1000px){ .wrap{grid-template-columns:1fr} .prediction-area{grid-template-columns:1fr} }
</style>
</head>
<body>
  <div style="width:1100px;max-width:98%;margin:auto">
    <header>
      <div class="logo">CP</div>
      <div>
        <h1>CoinPredict — Big/Small</h1>
        <div class="muted">50 free coins on signup • 10 coins per prediction • 1 coin = ₹0.5 • Min buy 100 coins</div>
      </div>
    </header>

    <div class="wrap">
      <!-- LEFT: wallet / buy / history -->
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
          <div>
            <div class="muted">Your Wallet</div>
            <div style="display:flex;gap:8px;align-items:center;margin-top:6px">
              <div class="coin-badge" id="coinCount">0</div>
              <div>
                <div style="font-weight:800">Coins</div>
                <div class="small">1 coin = ₹0.5</div>
              </div>
            </div>
          </div>
          <div style="display:flex;flex-direction:column;gap:8px">
            <button class="btn" id="buyBtn">Buy Coins</button>
            <button class="btn ghost" id="refill50">Claim 50 Free</button>
          </div>
        </div>

        <hr style="border:0;border-top:1px solid rgba(255,255,255,0.03)">

        <div style="margin-top:12px">
          <div class="muted">Quick actions</div>
          <div style="display:flex;gap:8px;margin-top:8px">
            <button class="btn" id="openPredict">Open Prediction</button>
            <button class="btn ghost" id="openHistory">History</button>
          </div>
        </div>

        <div style="margin-top:14px">
          <div class="muted">Purchase history (local demo)</div>
          <div class="history-list" id="purchaseHistory"></div>
        </div>
      </div>

      <!-- RIGHT: Prediction main -->
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div class="muted">Prediction Panel</div>
            <div style="font-weight:900;font-size:16px">Enter period → Generate prediction</div>
          </div>
          <div class="muted">Cost per prediction: <strong>10 coins</strong></div>
        </div>

        <div style="margin-top:12px" class="prediction-area">
          <div>
            <div class="pred-box">
              <div class="muted">Current Period</div>
              <div class="period" id="periodDisplay">—</div>

              <div style="margin-top:12px">
                <input id="periodInput" class="input" placeholder="Enter period (e.g. 20250914100011151)">
              </div>

              <div style="display:flex;gap:8px;margin-top:12px">
                <button class="btn" id="generateBtn">Generate Prediction</button>
                <button class="btn ghost" id="autoInc">Auto-inc ON</button>
              </div>

              <div class="anim-bar" style="margin-top:12px">
                <div class="progress" id="progressBar"></div>
              </div>

              <div style="margin-top:12px" id="predictionResult" class="center">
                <!-- result displayed here -->
                <div style="width:100%">
                  <div id="predLabel" style="font-size:14px" class="muted center">No prediction yet</div>
                  <div style="display:flex;gap:8px;justify-content:center;margin-top:8px">
                    <div id="predSign" style="min-width:120px"></div>
                  </div>
                  <div id="predNums" class="numbers" style="margin-top:8px"></div>
                </div>
              </div>

              <div style="display:flex;gap:8px;justify-content:center;margin-top:12px">
                <button class="btn" id="markWin" style="background:#2fb27f">Mark Win</button>
                <button class="btn" id="markLoss" style="background:#ff6b6b">Mark Loss</button>
              </div>
            </div>
          </div>

          <div>
            <div class="pred-box">
              <div class="muted">Summary</div>
              <div style="display:flex;justify-content:space-between;gap:8px;margin-top:8px">
                <div><div class="small">Predictions made</div><div id="madeCount" style="font-weight:800">0</div></div>
                <div><div class="small">Wins</div><div id="winsCount" style="font-weight:800">0</div></div>
                <div><div class="small">Losses</div><div id="lossCount" style="font-weight:800">0</div></div>
              </div>

              <div style="margin-top:12px">
                <div class="small muted">History (latest first)</div>
                <div class="history-list" id="predHistory"></div>
              </div>
            </div>

            <div class="pred-box" style="margin-top:12px">
              <div class="muted">Design & Animation</div>
              <div style="margin-top:8px" class="small">Smooth generator animation, neon accents & incremental period auto-increment after each successful generation (if Auto-inc ON).</div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <div style="height:12px"></div>
    <div class="muted center">This is a frontend demo. Replace payment/UTR handling with secure backend before going live.</div>
  </div>

  <!-- Buy modal -->
  <div class="modal" id="buyModal">
    <div class="modal-card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:800">Buy Coins</div>
        <div class="small muted">Min 100 coins</div>
      </div>

      <div style="margin-top:12px">
        <label class="small">How many coins?</label>
        <input id="buyCount" class="input" placeholder="100">
        <div class="small muted" style="margin-top:6px">Price: <span id="buyPrice">₹0</span></div>
      </div>

      <div style="margin-top:12px">
        <label class="small">Scan & Pay (QR)</label>
        <div style="display:flex;gap:8px;align-items:center">
          <div style="width:100px;height:100px;border-radius:8px;background:linear-gradient(90deg,#111,#222);display:flex;align-items:center;justify-content:center;color:var(--muted)">QR.png</div>
          <div>
            <div class="small muted">Scan this QR in your UPI app and pay the amount.</div>
            <input id="buyUTR" class="input" placeholder="Enter 12-digit UTR after payment" style="margin-top:8px">
          </div>
        </div>
      </div>

      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
        <button class="btn ghost" id="buyCancel">Cancel</button>
        <button class="btn" id="buyConfirm">Confirm Purchase</button>
      </div>
    </div>
  </div>

<script>
/* ---------- Storage keys ---------- */
const KEY_COINS = 'cp_coins_v1';
const KEY_PURCHASES = 'cp_purchases_v1';
const KEY_PREDH = 'cp_predhist_v1';
const KEY_FREE_CLAIMED = 'cp_free50_v1';

/* ---------- Initial state ---------- */
function getCoins(){ return parseInt(localStorage.getItem(KEY_COINS) || '0', 10); }
function setCoins(v){ localStorage.setItem(KEY_COINS, String(v)); updateCoinUI(); }
function addCoins(v){ setCoins(getCoins() + v); }
function addPurchaseRecord(rec){
  const arr = JSON.parse(localStorage.getItem(KEY_PURCHASES) || '[]');
  arr.unshift(rec);
  localStorage.setItem(KEY_PURCHASES, JSON.stringify(arr.slice(0,200)));
  renderPurchases();
}
function addPredictionRecord(rec){
  const arr = JSON.parse(localStorage.getItem(KEY_PREDH) || '[]');
  arr.unshift(rec);
  localStorage.setItem(KEY_PREDH, JSON.stringify(arr.slice(0,200)));
  renderPredHistory();
}
function getPredHistory(){ return JSON.parse(localStorage.getItem(KEY_PREDH) || '[]'); }

/* ---------- Init on first visit: give 50 free coins if not claimed ---------- */
if(!localStorage.getItem(KEY_COINS)){
  localStorage.setItem(KEY_COINS, '50'); // initial 50 coins
}
updateCoinUI();
renderPurchases();
renderPredHistory();

/* ---------- UI helpers ---------- */
function updateCoinUI(){
  document.getElementById('coinCount').innerText = getCoins();
}
document.getElementById('refill50').addEventListener('click', ()=>{
  if(localStorage.getItem(KEY_FREE_CLAIMED)){ alert('Free 50 already claimed'); return; }
  addCoins(50);
  localStorage.setItem(KEY_FREE_CLAIMED, '1');
  addPurchaseRecord({type:'free', coins:50, ts:Date.now(), note:'50 free coins'});
  alert('50 coins added to your wallet');
});

/* Purchase modal */
const buyModal = document.getElementById('buyModal');
document.getElementById('buyBtn').addEventListener('click', ()=>{
  buyModal.classList.add('show');
  document.getElementById('buyCount').value = '100';
  updateBuyPrice();
});
document.getElementById('buyCancel').addEventListener('click', ()=> buyModal.classList.remove('show'));
document.getElementById('buyCount').addEventListener('input', updateBuyPrice);

function updateBuyPrice(){
  const c = parseInt(document.getElementById('buyCount').value || '0',10);
  const price = Math.max(0, c) * 0.5;
  document.getElementById('buyPrice').innerText = '₹' + price.toFixed(2);
}

/* Confirm purchase (demo: credits immediately) */
document.getElementById('buyConfirm').addEventListener('click', ()=>{
  const c = parseInt(document.getElementById('buyCount').value || '0',10);
  if(isNaN(c) || c < 100){ alert('Minimum 100 coins'); return; }
  const utr = document.getElementById('buyUTR').value.trim();
  if(!/^\d{6,18}$/.test(utr)){ if(!confirm('UTR looks empty/invalid. Continue as demo and credit coins immediately?')) return; }
  // In real scenario: create a pending purchase record and wait admin/payment gateway confirmation
  addCoins(c);
  addPurchaseRecord({type:'buy', coins:c, price: c*0.5, utr: utr||'demo', ts:Date.now()});
  buyModal.classList.remove('show');
  alert('Purchase confirmed (demo). Coins added.');
});

/* Render purchases (left panel) */
function renderPurchases(){
  const arr = JSON.parse(localStorage.getItem(KEY_PURCHASES) || '[]');
  const el = document.getElementById('purchaseHistory');
  el.innerHTML = '';
  if(arr.length === 0){ el.innerHTML = '<div class="small">No purchases</div>'; return; }
  arr.slice(0,10).forEach(p=>{
    const d = document.createElement('div');
    d.style.padding = '8px';
    d.style.borderBottom = '1px solid rgba(255,255,255,0.02)';
    d.innerHTML = `<div style="display:flex;justify-content:space-between"><div style="font-weight:700">${p.type}</div><div class="small muted">${new Date(p.ts).toLocaleString()}</div></div>
      <div class="small muted">Coins: ${p.coins} • Price: ₹${(p.price||p.coins*0.5).toFixed(2)} ${p.utr?('• UTR:'+p.utr):''}</div>`;
    el.appendChild(d);
  });
}

/* ---------- Prediction logic UI ---------- */
const progressBar = document.getElementById('progressBar');
let generatorRunning = false;
let autoInc = true;
document.getElementById('autoInc').addEventListener('click', ()=>{
  autoInc = !autoInc;
  document.getElementById('autoInc').innerText = autoInc ? 'Auto-inc ON' : 'Auto-inc OFF';
});

/* Generate prediction event */
document.getElementById('generateBtn').addEventListener('click', async ()=>{
  if(generatorRunning) return;
  const periodStr = (document.getElementById('periodInput').value || '').trim();
  if(!periodStr){ alert('Enter a period number (e.g. 20250914100011151)'); return; }
  const coins = getCoins();
  if(coins < 10){ if(confirm('Not enough coins. Buy now?')) document.getElementById('buyBtn').click(); return; }

  // debit 10 coins now
  setCoins(coins - 10);

  generatorRunning = true;
  // animate progress over ~1.3-1.8s with random split
  progressBar.style.width = '0%';
  document.getElementById('predLabel').innerText = 'Analyzing...';
  document.getElementById('predSign').innerHTML = '';
  document.getElementById('predNums').innerText = '';
  let totalMs = 1200 + Math.random()*900;
  let t=0;
  const step = 40;
  while(t < totalMs){
    await new Promise(r=>setTimeout(r, step));
    t += step;
    const pct = Math.min(100, Math.round((t/totalMs)*100));
    progressBar.style.width = pct + '%';
  }

  // Decide prediction: random 50/50 (user asked for random)
  const pred = Math.random() < 0.5 ? 'Small' : 'Big';
  // numbers generation
  let a = 0, b = 0;
  if(pred === 'Small'){ a = randInt(0,4); b = randInt(0,4); }
  else { a = randInt(5,9); b = randInt(5,9); }

  // show result with animation
  const predSignEl = document.getElementById('predSign');
  predSignEl.innerHTML = pred === 'Big' ? `<div class="result-big">BIG</div>` : `<div class="result-small">SMALL</div>`;
  document.getElementById('predNums').innerText = `${a} / ${b}`;
  document.getElementById('predLabel').innerText = 'Prediction';

  // record history
  const rec = { period: periodStr, pred, nums:[a,b], ts: Date.now() };
  addPredictionRecord(rec);
  incrementCounters();

  // auto-increment period if ON
  if(autoInc){
    const next = incrementPeriodString(periodStr);
    document.getElementById('periodInput').value = next;
    document.getElementById('periodDisplay').innerText = next;
  } else {
    document.getElementById('periodDisplay').innerText = periodStr;
  }

  progressBar.style.width = '100%';
  generatorRunning = false;
});

/* Mark win/loss */
document.getElementById('markWin').addEventListener('click', ()=>{
  const hist = getPredHistory();
  if(!hist || hist.length===0){ alert('No predictions to mark'); return; }
  // mark last prediction result as win
  const last = hist[0];
  last.result = 'WIN';
  last.markedTs = Date.now();
  localStorage.setItem(KEY_PREDH, JSON.stringify(hist));
  renderPredHistory();
  incrementWinLoss(true);
});
document.getElementById('markLoss').addEventListener('click', ()=>{
  const hist = getPredHistory();
  if(!hist || hist.length===0){ alert('No predictions to mark'); return; }
  const last = hist[0];
  last.result = 'LOSS';
  last.markedTs = Date.now();
  localStorage.setItem(KEY_PREDH, JSON.stringify(hist));
  renderPredHistory();
  incrementWinLoss(false);
});

/* counters */
function incrementCounters(){
  const meta = JSON.parse(localStorage.getItem('cp_meta_v1') || '{}');
  meta.made = (meta.made||0) + 1;
  localStorage.setItem('cp_meta_v1', JSON.stringify(meta));
  renderCounters();
}
function incrementWinLoss(win){
  const meta = JSON.parse(localStorage.getItem('cp_meta_v1') || '{}');
  meta.wins = (meta.wins||0) + (win?1:0);
  meta.losses = (meta.losses||0) + (win?0:1);
  localStorage.setItem('cp_meta_v1', JSON.stringify(meta));
  renderCounters();
}
function renderCounters(){
  const meta = JSON.parse(localStorage.getItem('cp_meta_v1') || '{}');
  document.getElementById('madeCount').innerText = meta.made||0;
  document.getElementById('winsCount').innerText = meta.wins||0;
  document.getElementById('lossCount').innerText = meta.losses||0;
}
renderCounters();

/* render pred history */
function renderPredHistory(){
  const arr = getPredHistory();
  const el = document.getElementById('predHistory');
  el.innerHTML = '';
  if(arr.length === 0){ el.innerHTML = '<div class="small muted">No predictions yet</div>'; return; }
  arr.slice(0,30).forEach(it=>{
    const div = document.createElement('div');
    div.className = 'hitem';
    div.innerHTML = `<div>
        <div style="font-weight:800">${it.period}</div>
        <div class="small muted">${new Date(it.ts).toLocaleString()}</div>
      </div>
      <div style="text-align:right">
        <div style="margin-bottom:6px">${it.pred === 'Big' ? '<span class="big-pill">BIG</span>' : '<span class="small-pill">SMALL</span>'}</div>
        <div class="small muted">${it.nums ? it.nums.join(' / ') : ''} ${it.result ? ('• ' + it.result) : ''}</div>
      </div>`;
    el.appendChild(div);
  });
}

/* purchases history render already done earlier */

/* Utility: random int inclusive */
function randInt(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }

/* Increment period string by +1 on its numeric suffix
   If period has trailing digits, increment those preserving length.
   Else append '1' */
function incrementPeriodString(s){
  if(!s) return '';
  // find trailing numeric sequence
  const m = s.match(/(.*?)(\d+)$/);
  if(!m) return s + '1';
  const prefix = m[1];
  const num = m[2];
  const len = num.length;
  const n = BigInt(num) + 1n;
  let ns = n.toString();
  // preserve leading zeros if length stays same, else let it grow
  if(ns.length < len) ns = ns.padStart(len, '0');
  return prefix + ns;
}

/* Open/close panels shortcuts */
document.getElementById('openPredict').addEventListener('click', ()=> {
  document.getElementById('periodInput').focus();
});
document.getElementById('openHistory').addEventListener('click', ()=> {
  document.getElementById('predHistory').scrollIntoView({behavior:'smooth'});
});

/* Render purchase and pred history initial */
renderPurchases();
renderPredHistory();

/* If period display empty fill with sample */
if(!document.getElementById('periodInput').value) {
  document.getElementById('periodInput').value = '20250914100011151';
  document.getElementById('periodDisplay').innerText = document.getElementById('periodInput').value;
}

/* Simple keyboard: Enter to generate */
document.getElementById('periodInput').addEventListener('keydown', (e)=>{
  if(e.key === 'Enter') document.getElementById('generateBtn').click();
});

/* End of script */
</script>
</body>
</html>
