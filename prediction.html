<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mr Perfect Pro - Updated</title>
<link rel="icon" href="assets/favicon.png" />
<style>
:root{--accent:#0ea5a4;--bg:#0b1020;--card:#071126;color:#e6f7fb;font-family:system-ui,-apple-system,Segoe UI,Roboto,'Noto Sans',Ubuntu,'Helvetica Neue',Arial}
body{margin:0;background:#071226;color:var(--card);font-family:Inter,system-ui,Segoe UI,Roboto,'Noto Sans',Arial}
.app-bg{min-height:100vh;background-size:cover;background-position:center;padding:20px;}
.header{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;background:linear-gradient(90deg,rgba(255,255,255,0.03),transparent);border-radius:12px}
.card{background:rgba(255,255,255,0.02);padding:18px;border-radius:12px;box-shadow:0 6px 18px rgba(2,6,23,0.6)}
button{background:var(--accent);color:#001;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:600}
.input{padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--card);width:100%}
.small{font-size:0.9rem;color:#bfeeea}
.footer{margin-top:18px;color:#9fcfd0;font-size:0.85rem}
.hide{display:none}
.cross-admin{position:fixed;right:18px;top:18px;background:rgba(0,0,0,0.6);padding:8px;border-radius:999px;cursor:pointer;z-index:80}
.modal{position:fixed;left:0;right:0;top:0;bottom:0;display:flex;align-items:center;justify-content:center;background:rgba(2,6,12,0.6);z-index:90}
.modal .box{width:340px;padding:18px;border-radius:12px;background:linear-gradient(180deg,#041226,#062034);box-shadow:0 10px 30px rgba(2,6,23,0.6)}
.step{margin:12px 0;padding:12px;border-radius:10px;background:rgba(255,255,255,0.02)}
.badge{display:inline-block;padding:6px 8px;border-radius:8px;background:rgba(255,255,255,0.03);font-weight:700}
</style>

<!-- Firebase SDKs (user-provided config) -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-analytics.js";
  import { getStorage, ref as sref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-storage.js";
  import { getDatabase, ref as dbref, set, push, onValue } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBs7eQyMrcN8kJWMHl2ac2UZHlYQ6DypD8",
    authDomain: "terminal-xxrr.firebaseapp.com",
    databaseURL: "https://terminal-xxrr-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "terminal-xxrr",
    storageBucket: "terminal-xxrr.firebasestorage.app",
    messagingSenderId: "722753278120",
    appId: "1:722753278120:web:bfa37aab39635a4e57f29d",
    measurementId: "G-E3MZH3E1K5"
  };
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  window._firebase = { app, analytics, getStorage, getDatabase, sref, dbref, uploadBytes, getDownloadURL, set, push, onValue };
</script>
</head>
<body>
<div class="app-bg" style="background-image:url('assets/anime3.png')">
  <div class="header card">
    <div><h3>Prediction</h3><div class="small">Enter last 10 results (Big/Small)</div></div>
    <div><a href="index.html"><button>Home</button></a></div>
  </div>

  <div style="margin-top:18px" class="card">
    <label class="small">Last 10 results (space separated e.g. Big Small Big ...)</label>
    <input id="last10" class="input" placeholder="Big Small Big Small Big Big Big Big Small Small" />
    <div style="margin-top:12px;display:flex;gap:8px">
      <button id="gen">Generate Prediction</button>
      <button id="autoNext">Auto Next Period</button>
    </div>

    <div id="resultArea" class="step" style="margin-top:12px"></div>

    <div style="margin-top:12px">
      <div class="badge">Win / Loss</div>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="markWin">Win</button>
        <button id="markLoss">Loss</button>
      </div>
    </div>
  </div>
</div>

<script>
// simple AI: count last 10 frequency and trend; recommend opposite if long streak, else majority
function analyze(list){
  list = list.map(s=>s.trim().toLowerCase()).filter(Boolean);
  if(list.length<4) return {msg:'Enter at least 4 results for decent prediction', ok:false};
  const freq = {big:0, small:0};
  for(const v of list){ if(v.startsWith('b')) freq.big++; else if(v.startsWith('s')) freq.small++; }
  const last = list[list.length-1].startsWith('b')? 'Big':'Small';
  // detect streak
  let streak=1;
  for(let i=list.length-2;i>=0;i--){ if(list[i].startsWith(list[list.length-1].charAt(0))) streak++; else break; }
  // bet sizing: base 5% of loss placeholder (we'll use default loss 100 if not set)
  const userLoss = Number(localStorage.getItem('user_loss')||100);
  const baseBet = Math.max(1, Math.round(userLoss*0.05));
  // strategy: if streak >=3, predict reversal else majority
  let prediction = (streak>=3) ? (last==='Big'?'Small':'Big') : (freq.big>freq.small?'Big':'Small');
  let confidence = Math.round((Math.max(freq.big,freq.small)/list.length)*100);
  // martingale level suggestion
  const martingale = prediction==='Big' ? 'If loss, next bet x2' : 'If loss, next bet x2';
  return {ok:true,prediction,confidence,streak,baseBet,martingale};
}

document.getElementById('gen').addEventListener('click', ()=>{
  const text = document.getElementById('last10').value;
  const arr = text.split(/\s+/).slice(-10);
  const r = analyze(arr);
  const area = document.getElementById('resultArea');
  if(!r.ok){ area.innerText = r.msg; return; }
  area.innerHTML = `<strong>Prediction:</strong> ${r.prediction} <br/><strong>Confidence:</strong> ${r.confidence}% <br/><strong>Streak:</strong> ${r.streak} <br/><strong>Suggested Bet:</strong> â‚¹${r.baseBet} <br/><strong>Martingale:</strong> ${r.martingale}`;
  // save temporary history
  const hist = JSON.parse(localStorage.getItem('pred_hist')||'[]');
  const nextPeriod = Number(localStorage.getItem('period')||2025091500012053) + (hist.length+1);
  hist.push({period: nextPeriod, input: arr, prediction: r.prediction, confidence:r.confidence, bet:r.baseBet, time:Date.now()});
  localStorage.setItem('pred_hist', JSON.stringify(hist));
  // speak the steps in Hindi using Web Speech API
  speakHindi(`Prediction aayi hai. Agla result hone ki sambhavana ${r.prediction}. Aapka suggested bet rupees ${r.baseBet}. Yeh AI ki salah hai.`);
});

// speak helper
function speakHindi(text){
  try{
    const u = new SpeechSynthesisUtterance(text);
    u.lang = 'hi-IN';
    u.rate = 0.95;
    speechSynthesis.cancel();
    speechSynthesis.speak(u);
  }catch(e){ console.warn('TTS not supported',e); }
}

// Win/Loss buttons influence next suggestions
document.getElementById('markWin').addEventListener('click', ()=>{
  alert('Marked Win. AI will adapt next suggestion.');
  // simple adaptation: reduce baseLoss
  let loss = Number(localStorage.getItem('user_loss')||100);
  loss = Math.max(0, loss - 10);
  localStorage.setItem('user_loss', loss);
});
document.getElementById('markLoss').addEventListener('click', ()=>{
  alert('Marked Loss. AI will adapt next suggestion.');
  let loss = Number(localStorage.getItem('user_loss')||100);
  loss = loss + 10;
  localStorage.setItem('user_loss', loss);
});
</script>
</body>
</html>
